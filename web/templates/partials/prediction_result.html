<div class="bg-white rounded-lg shadow p-6">
    <h3 class="text-lg font-semibold mb-4">Prediction Result</h3>

    <!-- Main prediction -->
    <div class="flex items-center justify-between mb-6 p-4 bg-purple-50 rounded">
        <div>
            <p class="text-sm text-gray-600">Predicted Class</p>
            <p class="text-3xl font-bold text-purple-600">{{ result.predicted_class }}</p>
        </div>
        <div class="text-right">
            <p class="text-sm text-gray-600">Confidence</p>
            <p class="text-3xl font-bold">{{ "%.1f"|format(result.confidence * 100) }}%</p>
        </div>
    </div>

    <!-- Probability bars -->
    <h4 class="font-medium mb-2">Class Probabilities</h4>
    <div class="space-y-2 mb-6">
        {% for class_name, prob in result.probabilities.items() %}
        <div class="flex items-center">
            <span class="w-24 text-sm truncate">{{ class_name }}</span>
            <div class="flex-1 bg-gray-200 rounded-full h-4 mx-2">
                <div class="h-4 rounded-full transition-all duration-300 {% if class_name == result.predicted_class %}bg-purple-600{% else %}bg-gray-400{% endif %}"
                     style="width: {{ prob * 100 }}%"></div>
            </div>
            <span class="w-16 text-sm text-right">{{ "%.1f"|format(prob * 100) }}%</span>
        </div>
        {% endfor %}
    </div>

    {% if result.explanation %}
    <!-- Explanation section -->
    <div class="border-t pt-4">
        <h4 class="font-medium mb-3">Explanation</h4>

        <!-- Summary -->
        <div class="bg-gray-50 p-4 rounded mb-4">
            <p class="whitespace-pre-wrap text-sm">{{ result.summary_jp }}</p>
        </div>

        <!-- Word weights visualization -->
        <h5 class="text-sm font-medium mb-2">Important Words</h5>
        <div class="space-y-1">
            {% for word, weight in result.explanation.word_weights[:10] %}
            <div class="flex items-center text-sm">
                <span class="w-24 truncate font-mono" title="{{ word }}">{{ word }}</span>
                <div class="flex-1 mx-2 h-4 bg-gray-100 rounded overflow-hidden relative">
                    {% if weight > 0 %}
                    <div class="absolute left-1/2 h-full bg-green-500 rounded-r"
                         style="width: {{ (weight / max_weight * 50) | abs }}%"></div>
                    {% else %}
                    <div class="absolute right-1/2 h-full bg-red-500 rounded-l"
                         style="width: {{ (weight / max_weight * 50) | abs }}%"></div>
                    {% endif %}
                    <div class="absolute left-1/2 top-0 bottom-0 w-px bg-gray-300"></div>
                </div>
                <span class="w-20 text-right font-mono {% if weight > 0 %}text-green-600{% else %}text-red-600{% endif %}">
                    {{ "%+.3f"|format(weight) }}
                </span>
            </div>
            {% endfor %}
        </div>

        <p class="text-xs text-gray-500 mt-2">
            Green = supports "{{ result.predicted_class }}" | Red = opposes "{{ result.predicted_class }}"
        </p>
    </div>
    {% endif %}

    <!-- Input text reference -->
    <div class="border-t pt-4 mt-4">
        <h5 class="text-sm font-medium mb-2">Input Text</h5>
        <p class="text-sm text-gray-600 bg-gray-50 p-3 rounded max-h-32 overflow-y-auto">{{ text[:500] }}{% if text|length > 500 %}...{% endif %}</p>
    </div>
</div>
